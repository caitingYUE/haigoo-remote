# Haigoo 前台展示规则文档

## 文档概述

本文档详细阐述了 Haigoo 网站前台数据展示的规则和逻辑，包括数据展示策略、筛选规则、推荐算法、用户交互规范等，确保前台展示的一致性和用户体验的优化。

## 1. 数据展示逻辑

### 1.1 首页展示规则

#### 今日推荐展示
- **展示数量**: 默认显示 6 个推荐职位
- **排序规则**: 按推荐分数从高到低排序
- **更新频率**: 每日更新，基于最新的RSS数据同步
- **展示格式**: 3列网格布局（桌面端），2列（平板），1列（手机端）

#### 过往推荐展示
- **渐进式展开**: 4级展开状态
  - 级别0：隐藏所有历史推荐
  - 级别1：显示昨天推荐的所有岗位
  - 级别2：显示昨天 + 前天推荐的所有岗位
  - 级别3：显示昨天 + 前天 + 大前天推荐的所有岗位
- **数据保留**: 最多保存3天历史数据，超过自动清理
- **按钮状态**: "查看昨天推荐" → "查看更多历史" → "查看全部历史" → "收起"

### 1.2 职位列表页展示规则

#### 基础展示
- **分页机制**: 每页显示 20 个职位
- **排序选项**: 
  - 默认：按发布时间排序
  - 发布时间：最新优先
- **加载状态**: 显示加载动画，提供用户反馈

#### 职位卡片信息层次
1. **主要信息**（必显示）
   - 职位标题
   - 公司名称
   - 工作地点
   - 发布时间

2. **次要信息**（条件显示）
   - 薪资范围（如有）
   - 工作类型标签（合同/全职等）
   - 技能标签（最多显示3个，超出以 +N 展示）

3. **交互元素**
   - 立即申请按钮
   - 收藏按钮
   - 查看原始详情链接

### 1.3 职位详情页展示规则

#### 信息完整性
- **基本信息**: 岗位标题、公司、地点、薪资、工作类型、发布时间
- **详细描述**: 职位描述、工作职责、任职要求
- **公司信息**: 公司规模、行业类型、公司描述
- **福利待遇**: 薪资福利、工作环境、发展机会
- **申请信息**: 申请方式、联系信息、申请截止时间

#### 相关推荐
- **推荐逻辑**: 基于当前职位的类别、技能标签、薪资范围
- **展示数量**: 3-6个相关职位
- **排除规则**: 排除当前查看的职位

## 2. 筛选规则系统

### 2.1 筛选器配置

#### 工作类型筛选
```javascript
const jobTypes = [
  { value: 'all', label: '全部类型' },
  { value: 'remote', label: '远程' },
  { value: 'full-time', label: '全职' },
  { value: 'part-time', label: '兼职' },
  { value: 'contract', label: '合同' },
  { value: 'freelance', label: '自由职业' },
  { value: 'internship', label: '实习' }
];
```

#### 岗位分类筛选
```javascript
const jobCategories = [
  '前端开发', '后端开发', '全栈开发', '软件开发', 'DevOps',
  '数据科学', '产品经理', '项目经理', 'UI/UX设计', '移动开发',
  '算法工程师', '网络安全', '营销', '商业分析', '招聘', '营销', '其他'
];
```

#### 地点筛选
- **远程工作**: 优先显示，包含 `isRemote: true` 的职位
- **具体城市**: 支持主要城市筛选
- **全球职位**: 包含 "Worldwide"、"全球" 等关键词的职位

#### 经验等级筛选
```javascript
const experienceLevels = [
  { value: 'all', label: '全部等级' },
  { value: 'Entry', label: '初级' },
  { value: 'Mid', label: '中级' },
  { value: 'Senior', label: '高级' },
  { value: 'Lead', label: '技术负责人' },
  { value: 'Executive', label: '管理层' }
];
```

### 2.2 筛选逻辑实现

#### 搜索匹配逻辑
```javascript
const matchesSearch = searchTerm === '' || 
  job.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
  (job.company || '').toLowerCase().includes(searchTerm.toLowerCase()) ||
  (job.location || '').toLowerCase().includes(searchTerm.toLowerCase()) ||
  (job.skills && job.skills.some(skill => 
    skill.toLowerCase().includes(searchTerm.toLowerCase())
  ));
```

#### 复合筛选规则
- **AND逻辑**: 所有选中的筛选条件必须同时满足
- **OR逻辑**: 同一类别内的多个选项使用OR逻辑
- **优先级**: 搜索关键词 > 工作类型 > 岗位分类 > 地点 > 经验等级

### 2.3 筛选器UI规范

#### 交互设计
- **下拉选择器**: 使用统一的下拉组件
- **标题集成**: 筛选器标题作为placeholder显示
- **状态反馈**: 选中状态有明确的视觉反馈
- **清除功能**: 提供"清除所有筛选"按钮

#### 响应式适配
- **桌面端**: 水平排列的筛选器
- **移动端**: 折叠式筛选面板
- **无障碍**: 支持键盘导航和屏幕阅读器

## 3. 推荐算法规范

### 3.1 推荐分数计算

#### 基础分数体系
```javascript
let recommendationScore = 60; // 基础分数

// 远程工作且不限地点加分
if (job.isRemote) recommendationScore += 20;

// 技能标签加分
if (job.tags && job.tags.length > 0) {
  recommendationScore += Math.min(job.tags.length * 3, 15);
}

// 描述完整性加分
if (job.description && job.description.length > 100) {
  recommendationScore += 10;
}

// 公司信息完整性加分
if (job.company && job.company.trim()) {
  recommendationScore += 5;
}

// 随机因子（增加多样性）
recommendationScore += Math.random() * 15;
```

#### 分数权重说明
- **基础分数**: 60分（所有职位的起始分数）
 - **远程工作**: +20分（符合目标用户需求）
- **技能标签**: 每个标签+3分，最多+15分
- **描述完整性**: +10分（信息丰富度）
- **公司信息**: +5分（可信度）
- **随机因子**: 0-15分（避免排序过于固化）

### 3.2 分类匹配算法

#### 关键词映射系统
```javascript
const categoryKeywords = {
  '前端开发': [
    'frontend', 'front-end', 'react', 'vue', 'angular', 'javascript',
    'typescript', 'html', 'css', 'ui developer', 'web developer'
  ],
  '后端开发': [
    'backend', 'back-end', 'server', 'api', 'database', 'node.js',
    'python', 'java', 'php', 'ruby', 'go', 'rust'
  ],
  // ... 其他分类
};
```

#### 匹配优先级
1. **精确匹配**: 职位标题直接包含分类关键词
2. **描述匹配**: 职位描述中包含相关技能
3. **标签匹配**: 技能标签与分类关键词匹配
4. **默认分类**: 无法匹配时归类为"其他"

### 3.3 推荐历史管理

#### 数据结构
```javascript
interface RecommendationHistory {
  date: string; // YYYY-MM-DD格式
  jobs: PageJob[];
  // 推荐分组：每天两组，每组3个职位（共6个）
  recommendationGroup: 1 | 2;
}
```

#### 存储策略
- **本地存储**: 使用localStorage保存推荐历史
- **数据限制**: 最多保存3天数据
- **自动清理**: 每次加载时清理过期数据
- **增量更新**: 新推荐不覆盖历史数据

## 4. 用户交互规范

### 4.1 加载状态管理

#### 加载动画
- **初始加载**: 显示骨架屏或加载动画
- **筛选加载**: 显示小型加载指示器
- **分页加载**: 显示"加载更多"按钮状态

#### 错误处理
- **网络错误**: 显示重试按钮和错误提示
- **数据为空**: 显示友好的空状态页面
- **筛选无结果**: 提供清除筛选的建议

### 4.2 响应式设计规范

#### 断点设置
- **手机端**: < 768px
- **平板端**: 768px - 1024px
- **桌面端**: > 1024px

#### 布局适配
- **职位卡片**: 手机1列，平板2列，桌面3列
- **筛选器**: 手机折叠面板，桌面侧边栏
- **分页**: 手机简化版，桌面完整版

### 4.3 无障碍访问规范

#### 键盘导航
- **Tab顺序**: 逻辑清晰的焦点顺序
- **快捷键**: 支持常用快捷键操作
- **焦点管理**: 明确的焦点指示器

#### 屏幕阅读器支持
- **语义化标签**: 使用正确的HTML语义
- **ARIA标签**: 提供必要的ARIA属性
- **替代文本**: 为图像提供描述性文本

## 5. 性能优化规范

### 5.1 数据加载优化

#### 懒加载策略
- **图片懒加载**: 职位卡片中的公司logo
- **分页加载**: 避免一次性加载大量数据
- **预加载**: 预加载下一页数据

#### 缓存策略
- **本地缓存**: 缓存筛选结果和用户偏好
- **服务端缓存**: RSS数据的定时缓存
- **浏览器缓存**: 静态资源的长期缓存

### 5.2 渲染优化

#### 虚拟滚动
- **长列表**: 对超过100个职位的列表使用虚拟滚动
- **内存管理**: 及时清理不可见的DOM元素
- **滚动性能**: 优化滚动事件处理

#### 组件优化
- **React.memo**: 对职位卡片组件进行记忆化
- **useMemo**: 缓存计算结果
- **useCallback**: 缓存事件处理函数

## 6. 数据质量保证

### 6.1 数据验证规则

#### 必填字段验证
- **职位标题**: 不能为空，长度限制
- **公司名称**: 提供默认值处理
- **发布时间**: 格式验证和合理性检查

#### 数据清洗规则
- **重复数据**: 基于URL和标题去重
- **无效数据**: 过滤掉明显错误的数据
- **格式统一**: 统一日期、薪资等格式

### 6.2 内容质量控制

#### 文本处理
- **HTML清理**: 移除不安全的HTML标签
- **长度限制**: 控制描述文本的显示长度
- **特殊字符**: 处理编码问题和特殊字符

#### 图片处理
- **默认图片**: 为缺失的公司logo提供默认图片
- **尺寸优化**: 压缩和调整图片尺寸
- **格式支持**: 支持多种图片格式

## 7. 监控和分析

### 7.1 用户行为分析

#### 关键指标
- **点击率**: 职位卡片的点击转化率
- **筛选使用**: 各筛选器的使用频率
- **搜索热词**: 用户搜索的关键词统计
- **页面停留**: 用户在各页面的停留时间

#### 数据收集
- **事件追踪**: 用户交互事件的记录
- **性能监控**: 页面加载和渲染性能
- **错误监控**: JavaScript错误和API错误

### 7.2 A/B测试规范

#### 测试场景
- **推荐算法**: 不同推荐分数权重的效果
- **UI布局**: 不同卡片布局的用户偏好
- **筛选器**: 不同筛选器排列的使用效果

#### 测试指标
- **转化率**: 从浏览到申请的转化
- **用户满意度**: 通过用户反馈收集
- **系统性能**: 不同方案的性能影响

## 8. 开发和维护指南

### 8.1 代码规范

#### 组件开发
- **单一职责**: 每个组件只负责一个功能
- **可复用性**: 设计可复用的通用组件
- **类型安全**: 使用TypeScript确保类型安全

#### 状态管理
- **Zustand**: 使用Zustand进行全局状态管理
- **本地状态**: 合理使用useState和useReducer
- **副作用**: 使用useEffect处理副作用

### 8.2 测试策略

#### 单元测试
- **组件测试**: 测试组件的渲染和交互
- **工具函数**: 测试筛选和排序逻辑
- **API接口**: 测试数据获取和处理

#### 集成测试
- **用户流程**: 测试完整的用户操作流程
- **数据流**: 测试数据从获取到展示的完整流程
- **错误处理**: 测试各种错误场景的处理

### 8.3 部署和发布

#### 环境配置
- **开发环境**: 本地开发和调试配置
- **测试环境**: 集成测试和用户验收测试
- **生产环境**: 性能优化和监控配置

#### 发布流程
- **代码审查**: 确保代码质量和规范
- **自动化测试**: 运行完整的测试套件
- **灰度发布**: 逐步发布新功能
- **回滚机制**: 快速回滚有问题的版本

## 9. 未来优化方向

### 9.1 智能推荐

#### 个性化推荐
- **用户画像**: 基于用户行为构建画像
- **协同过滤**: 基于相似用户的推荐
- **内容推荐**: 基于职位内容的相似性推荐

#### 机器学习
- **点击预测**: 预测用户点击概率
- **薪资预测**: 基于职位信息预测薪资范围
- **匹配度评分**: 计算用户与职位的匹配度

### 9.2 用户体验优化

#### 交互优化
- **语音搜索**: 支持语音输入搜索
- **手势操作**: 移动端的手势导航
- **快捷操作**: 键盘快捷键和批量操作

#### 个性化界面
- **主题定制**: 支持多种界面主题
- **布局偏好**: 用户自定义布局选项
- **语言支持**: 多语言界面支持

---

## 总结

本文档详细规定了 Haigoo 网站前台展示的各项规则和标准，涵盖了数据展示、筛选逻辑、推荐算法、用户交互等各个方面。开发团队应严格按照本规范进行开发和维护，确保用户体验的一致性和系统的稳定性。

随着业务的发展和用户需求的变化，本规范将持续更新和完善，以适应新的需求和技术发展。
## 标签行显示规则（更新）

- 单行展示：岗位卡片与推荐卡上的标签行强制单行，使用 `flex-nowrap` 与 `overflow-hidden`，不允许换行。
- 动态聚合：当标签总宽度超过可用宽度时，自动计算可见标签数量，剩余以 `+N` 的圆角徽标聚合显示；`+N` 与可见标签保持同一行。
- 兜底逻辑：当某岗位不存在任何标签数据时，显示 `remote` 作为兜底标签（仅在标签长度为 0 时启用）。
- 一致性：上述规则在 `JobCard` 与 `RecommendationCard` 两类卡片中统一实现，保证卡片高度与布局对齐。
- 适配说明：窗口宽度变化时，通过 `ResizeObserver` 自动重新计算展示数量，避免布局抖动。

实现组件：`SingleLineTags`（`src/components/SingleLineTags.tsx`）
- 属性：`tags: string[]`、`size: 'xs' | 'sm'`、`fallback?: string`
- 默认兜底：`fallback` 默认值为 `remote`
- 算法：测量每个标签实际宽度，贪心放置并为 `+N` 预留宽度，确保整行不换行。